---
title: "R and Base R Graphics"
format:
  html:
    sidebar: true
    grid:
      sidebar-width: 420px
---

<div id="tutor-root" data-chapter="1_r_and_base_r_graphics" class="tutor-floating"></div>
<script src="../assets/tutor-chat.js"></script>
<link rel="stylesheet" href="../assets/tutor-chat.css">


## Preparation for Class

-   Watch the lecture recording

-   Do any required reading (see below)

-   Ask Dr. Lysenko any questions you have

-   Pass Dr. Lysenko's quiz

## Lecture Recording and Slides


```{=html}
<div class="yt-embed">
  <div class="ratio">
    <iframe
      src="https://www.youtube.com/embed/1QC1YdxK1rs"
      title="Lecture video"
      frameborder="0"
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
      allowfullscreen>
    </iframe>
  </div>
</div>
```


```{=html}
<div style="width: 100%; height: 800px; margin-top: 1.5em;">
  <iframe
    src="../lecture_slides/1_r_and_base_r_graphics/1_r_and_base_graphics.pdf"
    style="width: 100%; height: 100%; border: 1px solid #ccc;"
    title="Lecture slides">
  </iframe>
</div>
```


## Required Reading

No required reading.

## Suggested Reading

-   [R Base Graphics: An Idiot's Guide](https://rpubs.com/SusanEJohnston/7953)

-   [Exploratory Data Analysis with R: 9 The Base Plotting System](https://bookdown.org/rdpeng/exdata/the-base-plotting-system-1.html)

-   [The R Graph Gallery: Data visualization with base R](https://r-graph-gallery.com/base-R.html)

## In-class Exercises

[Download the exercises](../exercises/1_r_and_r_base_graphics/1_r_and_r_base_graphics_exercises.Rmd)

[Download the data for the exercises](../exercises/1_r_and_r_base_graphics/nggyu_syndrome.assoc.logistic)

::: {.callout-tip collapse="true"}

### Expand to see the answers

```{webr}
### 1
# Read in data
url <- "https://jmc108.github.io/hugen2073-textbook/exercises/1_r_and_r_base_graphics/nggyu_syndrome.assoc.logistic"
data <- read.table(url, header=TRUE, sep="\t")

# Inspect
head(data)
tail(data)
dim(data)

### 2-3
# Filter, and drop some columns
data <- data[data$TEST=="SNP" & data$NMISS >= 995, -which(names(data) %in% c("A1","TEST","STAT"))]
# Did it work?
dim(data)
names(data)
sum(data$NMISS < 995, na.rm=TRUE)

### 4
# Add a new column
data$nlp <- -log10(data$P)
head(data)

### 5
# Apply a function
ld <- function(df) {
  # Get top SNP's position
  top_snp_bp <- df$BP[ which(df$P == min(df$P)) ]
  
  # Get distances from it
  dist_from_top_snp <- abs(df$BP - top_snp_bp)
  
  # Generate random LDs
  lds <- 1 - rnorm(mean=  (dist_from_top_snp/max(dist_from_top_snp))^(1/2)  , sd=0.01, n = dim(df)[1])
  lds[lds <=0] <- 0.01
  lds[which(df$P == min(df$P))] <- 1
  return(lds)
}

data$ld <- ld(data)
head(data)

### 6
# Modify values of color column
data$color <- NA
data$color[data$ld == 1] <- "purple"
data$color[data$ld >= 0.8 & data$ld < 1] <- "red"
data$color[data$ld >= 0.6 & data$ld < 0.8] <- "orange"
data$color[data$ld >= 0.4 & data$ld < 0.6] <- "green"
data$color[data$ld >= 0.2 & data$ld < 0.4] <- "light blue"
data$color[data$ld < 0.2] <- "dark blue"

# Inspect
head(data)
table(data$color, useNA="always")

### 7
# Modify values of pch column
data$pch <- ifelse(data$OR > 1, 2, 6)
table(data$pch, useNA="always")

### 8-9
# Plot
plot(x=data$BP, y=data$nlp, pch=data$pch, col=data$color, cex=0.6, xlab="Base-pair position", ylab="-log10(p)", main="Nggyu Syndrome Associations")

### 10
# Write out data
# write.csv(x=data, file="./nggyu_results_processed.csv", quote=FALSE, row.names=FALSE, col.names=TRUE)
```

:::
